{% extends "logged_in.html" %}

{% block title_fitness_testing_base %}
    {{ user_tab_page_title }}
{% endblock %}

{% block content_logged_in %}

    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-4 col-md-3 sidebar" style="padding-top: 2px">
                <div style="border: 2px solid black">
                    <ul class="nav nav-sidebar" id="main_view_links">
                        {% for link_label, link_url, load_type in user_tabs %}
                            <li load_type="{{ load_type }}">
                                <a href="{{ link_url }}">{{ link_label }}</a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>

                {% if step_sets %}

                    <br>
                    <div style="color: #808080">
                        <h3 align="center">Steps</h3>
                        <div style="font-weight: bold" align="center">
                            (Click a step below to show instructions)
                        </div>
                        <ul class="nav nav-sidebar" id="short_instructions_links">
                            {% for steps, steps_text in step_sets %}
                                <br>
                                <div style="height: 1px; background-color: transparent; text-align: left; padding-left: 10px">
                                    <span style="font-weight: bold; background-color: white;
                                     position: relative; top: -0.6em">
                                        {{ steps_text }}
                                    </span>
                                </div>
                                <div class="nav nav-sidebar short_instructions_links" style="border: 2px solid; padding: 10px">
                                    {% for step_text, step_link, images in steps %}
                                        <li><a href="" value="{{ forloop.parentloop.counter0 }}:{{ forloop.counter0 }}">
                                            {{ step_text }}
                                        </a></li>
                                    {% endfor %}
                                </div>
                            {% endfor %}
                        </ul>
                    </div>

                    <script>
                        function show_short_step(outer_loop_count_show, inner_loop_count_show) {
                            {% for steps, steps_text in step_sets %}
                                var outer_loop_count = {{ forloop.counter0 }}
                                {% for step_text, step_link, images in steps %}
                                    var inner_loop_count = {{ forloop.counter0 }}
                                    var instruction_id = "short_step_instruction_" + outer_loop_count + "_" + inner_loop_count;
                                    var instruction_to_show = document.getElementById(instruction_id);
                                    if((outer_loop_count == outer_loop_count_show) && (inner_loop_count == inner_loop_count_show))
                                        instruction_to_show.style.display = "inherit";
                                    else
                                        instruction_to_show.style.display = "none";
                                {% endfor %}
                            {% endfor %}
                        }

                        function close_short_instructions() {
                            show_short_step(-1, -1);
                        }
                    </script>
                {% endif %}
            </div>
            <div class="col-sm-8 col-md-9" id="main_view_container">
                <div id="main_view_top"></div>
                <div id="main_view_middle">
                {% if step_sets %}
                    {% for steps, steps_text in step_sets %}
                        {% for step_text, step_link, images in steps %}
                            <div style="padding-top: 20px; padding-bottom: 20px; display: none"
                                 id="short_step_instruction_{{ forloop.parentloop.counter0 }}_{{ forloop.counter0 }}">
                                <div style="height: 1px; background-color: transparent; text-align: left; padding-left: 10px">
                                    <span style="color: #808080; background-color: white; position: relative;
                                     top: -0.6em; font-size: 20px">
                                        &nbsp Instructions &nbsp
                                    </span>
                                </div>
                                <div style="padding-left: 20px; padding-bottom: 10px; border: 2px solid #808080">
                                    <table><tr>
                                        <td>
                                            <h3 style="color: #428bca">
                                                {{ step_text }}
                                            </h3>
                                            {% if images %}
                                                <div style="padding-bottom: 10px"><table><tr>
                                                    {% for image, text in images %}
                                                        <td>
                                                            {% if text %}
                                                                <div style="height: 1px; background-color: transparent;
                                                                 text-align: center">
                                                                    <span style="color: purple; font-size: 10px; font-weight: bold;
                                                                     background-color: white; position: relative;
                                                                     top: -1.1em">
                                                                        &nbsp {{ text }} &nbsp
                                                                    </span>
                                                                </div>
                                                            {% endif %}
                                                            {% if text %}
                                                                <div style="border: 3px solid purple; padding-left: 8px;
                                                                 padding-right: 8px; padding-top: 8px; padding-bottom: 8px">
                                                            {% endif %}
                                                            <img src="/static/images/instructions_quick/{{ image }}"
                                                                 style="border:1px solid black"/>
                                                            {% if text %}
                                                                </div>
                                                            {% endif %}
                                                        </td>
                                                        {% if not forloop.last %}
                                                            <td>
                                                                <img src="/static/images/instructions_quick/arrow3.png"/>
                                                            </td>
                                                        {% endif %}
                                                    {% endfor %}
                                                </tr></table></div>
                                            {% endif %}
                                            <a href="{{ step_link }}" target="_blank" style="color: orangered;
                                             font-size: 15px">
                                                Click here for more detailed instructions (will open in a new tab)
                                            </a>
                                        </td>
                                        <td height="100%" width="100%" style="vertical-align: top">
                                            <button type="button" style="float: right" onclick="close_short_instructions()">
                                                x
                                            </button>
                                        </td>
                                    </tr></table>
                                </div>
                            </div>
                        {% endfor %}
                    {% endfor %}
                {% endif %}
                </div>
                <div id="main_view_bottom"></div>
            </div>
        </div>
    </div>

    <script>
        {% include 'javascript_additions/ajax_user_tab_page.js' %}
        {% include 'javascript_additions/ajax_include_with_user_tab_page.js' %}
    </script>

{% endblock %}
